# efw Excel 操作サンプル

## 概要

efwフレームワークは、Excel操作を簡素化するAPIセットを提供し、Apache POIの複雑な操作をカプセル化することで、Excelファイルの作成、編集、処理をより簡単で直感的にします。本サンプルは、efwフレームワークにおけるExcel操作の様々な機能を紹介します。

## コアファイル

1. **メインページ**: `helloExcel.jsp`
2. **Excel操作処理**: `helloExcel_submit.js`

## 機能特性

### 1. テンプレート駆動の操作
efw Excel APIはテンプレート駆動のアプローチを採用し、既存のテンプレートに基づいてワークシートとセルを迅速に作成し、スタイルとフォーマットの一貫性を維持します。

```javascript
// テンプレートに基づくワークシートの作成
.createSheet("newSheet", "templateSheet")

// テンプレートに基づくセルスタイルの設定
.setCell("sheetName", "A1", "value", "templateSheet", "B2")
```

### 2. 豊富なワークシート操作
- ワークシートの作成（テンプレート複製対応）
- ワークシート順序の調整
- ワークシートの表示/非表示
- ワークシートの削除
- アクティブワークシートの設定
- 印刷領域の設定

### 3. 柔軟な行と列の管理
- 行の追加/削除
- 行と列の表示/非表示
- 動的な行と列のレイアウト調整

### 4. データ操作機能
- セル値とスタイルの設定
- ハイパーリンクの作成
- 様々なデータタイプのサポート（テキスト、数値、日付）
- バッチデータ読み取り（フォーマットとコールバック対応）

### 5. グラフィック処理能力
- 様々な形状の追加（円、矩形など）
- グラフィック位置の精密な指定
- 画像置換機能
- グラフィック状態のチェック

### 6. 数式サポート
- 数式の自動適用
- 数式計算機能の維持

## 使用説明

### 1. 基本的なワークフロー
```javascript
// 1. Excelファイルの作成または開く
var excel = new Excel("template.xlsx");

// 2. 様々な操作の実行
excel.createSheet("newSheet", "templateSheet")
    .setCell("newSheet", "A1", "Hello World")
    .addRow("newSheet", 0);

// 3. ファイルの保存
excel.save("output.xlsx");

// 4. ファイルの閉じる
excel.close();
```

### 2. データ読み取りサンプル
```javascript
// 配列データの読み取り
var data = excel.getArray("Sheet1", 1, 1, {
    name: "A",
    age: "B",
    salary: ["C", "#,##0.00"],
    date: ["D", "yyyy/MM/dd"]
});
```

// 単一セルの値読み取り
var value = excel.getValue("Sheet1", "A1");


### 3. グラフィック操作サンプル
```javascript
// グラフィックの追加、myCircleはテンプレート上に既に準備されているグラフィックの名前
excel.addShape("Sheet1", "B2", "TemplateSheet", "myCircle", "Circle Text");

// グラフィックで覆われているかどうかのチェック
var tf = excel.isEncircled("Sheet1", "A1", 0.5, 0.5);
```

## 技術的優位性

### 1. 複雑な操作の簡素化
efw Excel APIはApache POIの複雑な操作をカプセル化し、Excelファイル処理をより簡単で直感的にします。

### 2. テンプレートの再利用
テンプレートベースの操作をサポートし、スタイルとフォーマットの一貫性を確保し、開発効率を向上させます。

### 3. チェーン呼び出し
チェーン呼び出しをサポートし、コードをより簡潔で読みやすくします。

### 4. タイプセーフ
完全なタイプサポートを提供し、実行時エラーを減少させます。

## まとめ

efwフレームワークのExcel操作APIは、シンプルで強力なソリューションを提供し、Excelファイルの作成、編集、処理作業を大幅に簡素化します。テンプレート駆動の設計と豊富な機能セットにより、開発者はApache POIの複雑な詳細を深く理解することなく、複雑なExcel操作要件を迅速に実現できます。

このAPIは、ワークシート管理、行と列の操作、データ処理、グラフィック操作、数式計算など、様々な操作タイプをサポートし、ほとんどのExcel処理シナリオの要件を満たすことができます。チェーン呼び出しの設計により、コードはより簡潔で読みやすくなり、開発効率とコード品質を向上させます。
