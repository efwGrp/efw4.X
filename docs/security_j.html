<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EFWフレームワークのセキュリティ機能 - Webアプリケーションの総合的な保護</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans JP', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            padding: 0;
            margin: 0;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(120deg, #2c3e50 0%, #4a6491 100%);
            color: white;
            padding: 50px 20px;
            text-align: center;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 40px;
        }
        
        .logo {
            font-size: 42px;
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .logo span {
            background: linear-gradient(45deg, #ff7b72, #4299e1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
        }
        
        .subtitle {
            font-size: 1.4rem;
            font-weight: 300;
            max-width: 800px;
            margin: 0 auto;
            opacity: 0.9;
        }
        
        .section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease;
        }
        
        .section:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .section-title {
            color: #2c3e50;
            font-size: 1.8rem;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #4299e1;
            display: flex;
            align-items: center;
        }
        
        .section-title i {
            margin-right: 10px;
            color: #4299e1;
        }
        
        .subsection {
            margin-bottom: 25px;
        }
        
        .subsection-title {
            color: #4299e1;
            font-size: 1.4rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .subsection-title i {
            margin-right: 8px;
        }
        
        .problem-solution {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .problem, .solution {
            flex: 1;
            padding: 20px;
            border-radius: 10px;
        }
        
        .problem {
            background: #fff5f5;
            border-left: 5px solid #e53e3c;
        }
        
        .solution {
            background: #ebf8ff;
            border-left: 5px solid #4299e1;
        }
        
        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }
        
        .card-title {
            font-size: 1.3rem;
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .card-title i {
            margin-right: 10px;
            color: #4299e1;
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            margin: 15px 0;
        }
        
        .keyword {
            color: #ff7b72;
        }
        
        .string {
            color: #a3bffa;
        }
        
        .comment {
            color: #a0aec0;
        }
        
        .highlight {
            background: linear-gradient(120deg, #bee3f8 0%, #ebf8ff 100%);
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            border: 2px solid #bee3f8;
        }
        
        .highlight-text {
            font-size: 1.5rem;
            font-weight: 500;
            color: #2c5282;
            margin-bottom: 15px;
        }
        
        .btn {
            display: inline-block;
            background: #4299e1;
            color: white;
            padding: 12px 25px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }
        
        .btn:hover {
            background: #3182ce;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(66, 153, 225, 0.3);
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid #4299e1;
            color: #4299e1;
        }
        
        .btn-outline:hover {
            background: #4299e1;
            color: white;
        }
        
        footer {
            background: #2d3748;
            color: white;
            text-align: center;
            padding: 30px;
            margin-top: 50px;
            border-radius: 20px 20px 0 0;
        }
        
        @media (max-width: 768px) {
            .problem-solution {
                flex-direction: column;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .subtitle {
                font-size: 1.1rem;
            }
        }
        .language-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
            background: rgba(255, 255, 255, 0.5);
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .lang-btn {
            background: #238636;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 10px 15px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }
        
        .lang-btn:hover {
            background: #2ea043;
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="language-switcher">
        <button class="lang-btn" onclick="switchLanguage('en')">
            English
        </button>
        <button class="lang-btn" onclick="switchLanguage('jp')">
            日本語
        </button>
        <button class="lang-btn" onclick="switchLanguage('cn')">
            中文
        </button>
    </div>
    <header>
        <div class="container">
            <div class="logo">
                <i class="fas fa-shield-alt"></i>
                <span>EFW</span>フレームワークのセキュリティ機能
            </div>
            <h1>Webアプリケーションの総合的な保護</h1>
            <p class="subtitle">EFWフレームワークが提供する多層的なセキュリティ保護メカニズムにより、様々な攻撃からWebアプリケーションを保護します</p>
            <div style="margin-top: 30px;">
                <a href="#intro" class="btn">詳細を見る</a>
                <a href="https://github.com/efwGrp/efw4.X" class="btn btn-outline">GitHubソース</a>
            </div>
        </div>
    </header>

    <div class="container">
        <section id="intro" class="section">
            <h2 class="section-title"><i class="fas fa-info-circle"></i> EFWフレームワークのセキュリティ概要</h2>
            <p>EFW（Escco-Framework）は、エスコ・ジャパン株式会社が<strong>目的指向アプローチ</strong>で設計・開発したサーバーサイドJavaScript Ajaxフレームワークで、多層的なセキュリティ保護メカニズムを提供します。</p>
            <p>EFWフレームワークは、ファイルセキュリティ、パラメータセキュリティ、インジェクション攻撃保護の3つの次元から、Webアプリケーションの安全性を包括的に保証します。</p>
            
            <div class="highlight">
                <p class="highlight-text">多層的なセキュリティ保護 - ファイル管理からインジェクション攻撃までの包括的な防御</p>
                <div>
                    <a href="#file-security" class="btn">ファイルセキュリティ</a>
                    <a href="#param-security" class="btn">パラメータセキュリティ</a>
                    <a href="#injection-security" class="btn">インジェクション保護</a>
                </div>
            </div>
        </section>

        <section id="file-security" class="section">
            <h2 class="section-title"><i class="fas fa-file-shield"></i> 1. ファイル漏洩防止対策</h2>
            
            <div class="subsection">
                <h3 class="subsection-title"><i class="fas fa-question-circle"></i> ファイル漏洩とは？</h3>
                <p>ファイル漏洩とは、Webサーバー内のファイルがインターネット上の攻撃者によってどんどん読み出されてしまうセキュリティ問題のカテゴリーである。これはWebアプリケーションの脆弱性のうちもっとも基本的なものだ。ファイル流出対策ができていないWebサイトは、最もセキュリティレベルの低いサイトの部類に入る。</p>
            </div>
            
            <div class="subsection">
                <h3 class="subsection-title"><i class="fas fa-folder"></i> 1-1. efwフォルダの置く場所</h3>
                <div class="problem-solution">
                    <div class="problem">
                        <h4><i class="fas fa-exclamation-triangle"></i> 従来の問題</h4>
                        <p>データの蓄積場所としてWeb公開領域を使っている、サーバー内のファイルを限定して提供するはずのプログラムが逆にあらゆるファイルを流出させてしまうなどの問題がある。</p>
                    </div>
                    <div class="solution">
                        <h4><i class="fas fa-check-circle"></i> EFWの解決策</h4>
                        <p>efwフレームワークのデフォルト設定で、アプリプログラムと各種リソース（jsp・cssなどを除く）は、Web非公開領域のWEB-INFフォルダに格納する。</p>
                        <ul>
                            <li>event：イベントjsファイルを格納するフォルダ</li>
                            <li>i18n：多国語メッセージ定義を格納するフォルダ</li>
                            <li>mail：メールテンプレートを格納するフォルダ</li>
                            <li>sql：外出しSQLを格納するフォルダ</li>
                            <li>storage：アプリが操作するファイルを格納するフォルダ</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="subsection">
                <h3 class="subsection-title"><i class="fas fa-tools"></i> 1-2. ファイル管理ツールelfinderの改造</h3>
                <div class="problem-solution">
                    <div class="problem">
                        <h4><i class="fas fa-exclamation-triangle"></i> オリジナルelfinderの問題点</h4>
                        <p>オリジナルのelfinderの場合、ホームパス、読み取り専用フラグは、クライアントjavaScriptで変更可能。</p>
                    </div>
                    <div class="solution">
                        <h4><i class="fas fa-check-circle"></i> EFWの改良点</h4>
                        <p>efwのelfinderタグに、protected属性を設けて、ホームパス、読み取り専用フラグを変更不可にする。</p>
                        <p>protected属性+ログインチェックとロールチェックにすれば、さらに安全な対策になる。</p>
                    </div>
                </div>
            </div>
            
            <div class="subsection">
                <h3 class="subsection-title"><i class="fas fa-download"></i> 1-3. ダウンロードの仕組み</h3>
                <div class="problem-solution">
                    <div class="problem">
                        <h4><i class="fas fa-exclamation-triangle"></i> 従来のダウンロードの問題点</h4>
                        <p>直接的なファイルアクセスにより、不正なファイルダウンロードが可能になるリスクがある。</p>
                    </div>
                    <div class="solution">
                        <h4><i class="fas fa-check-circle"></i> EFWの安全なダウンロード機構</h4>
                        <p>ダウンロードは、必ず一つのイベント発行からスタート。イベント実行とダウンロード開始の間、ダウンロード対象をセッションで保管する。</p>
                        <p>これにより、クライアントのJavaScript改ざんのみで、ダウンロードを実行させることはできない。</p>
                        <div class="code-block">
                            <span class="comment">// イベントJSでのダウンロード設定例</span><br>
                            <span class="keyword">return</span> (<span class="keyword">new</span> Result())<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;.attach(<span class="string">"myfile.txt"</span>);
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="param-security" class="section">
            <h2 class="section-title"><i class="fas fa-key"></i> 2. パラメータからの情報漏洩防止</h2>
            
            <div class="subsection">
                <h3 class="subsection-title"><i class="fas fa-question-circle"></i> パラメータからの情報漏洩とは？</h3>
                <p>あるページから次のページへと場面を切り替える際に受け渡されるパラメータがもとで、別人の個人情報が読み出されるなどの問題が起こる脆弱性のカテゴリーである。「情報流出」と名づけてはいるが、ショッピングサイトでパラメータがいじられ不当な安値で買い物されてしまうような改ざん系の問題もこのカテゴリーに含まれる。</p>
            </div>
            
            <div class="subsection">
                <h3 class="subsection-title"><i class="fas fa-check-double"></i> 2-1. イベントパラメータチェックの仕組み</h3>
                <p>クライアントから取得するイベントパラメータは、期待するタイプか否か、パラメータ定義でチェック行う仕組みがある。クライアント改ざんによるサーバー障害を防ぐ。</p>
                <div class="code-block">
                    <span class="keyword">var</span> myEvent = {};<br>
                    myEvent.paramsFormat = {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"#txt_date"</span>: <span class="string">"format:yyyy/MM/dd;required;display-name:日付項目"</span>,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"#txt_number"</span>: <span class="string">"format:###,##0;min:0;max:1,000;display-name:数値項目"</span>,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"#txt_string"</span>: <span class="string">"maxlength:100;display-name:文字項目"</span>,<br>
                    };
                </div>
            </div>
            
            <div class="subsection">
                <h3 class="subsection-title"><i class="fas fa-user-check"></i> 2-2. ログインチェックの仕組み</h3>
                <p>ログインしてから閲覧可能な画面・操作できるイベントを、プロパティファイル設定で自動的にログインチェックを行う仕組みがある。ログインせずのまま、そのアドレスをURL欄に直接入力による情報流出を防ぐ。</p>
                <div class="code-block">
                    <span class="comment"># ログインチェックフラグ</span><br>
                    efw.login.check = <span class="keyword">true</span><br>
                    <span class="comment"># ログインのセッションキー</span><br>
                    efw.login.key = USER_ID<br>
                    <span class="comment"># ログインURL</span><br>
                    efw.login.url = login.jsp<br>
                    <span class="comment"># ログインチェック除外URLパターン</span><br>
                    efw.outoflogin.url.pattern = [/](LG01|LG02|LG03|error).jsp
                </div>
            </div>
            
            <div class="subsection">
                <h3 class="subsection-title"><i class="fas fa-user-lock"></i> 2-3. ロールチェックの仕組み</h3>
                <p>管理者のみ閲覧可能な画面・操作できるイベントを、プロパティファイル極簡主义風格設定で自動的にロールチェックを行う仕組みがある。一般ユーザが管理者専用画面アドレスをURL欄に直接入力による情報流出を防ぐ。</p>
                <div class="code-block">
                    <span class="comment"># 権限チェックフラグ</span><br>
                    efw.auth.check = <span class="keyword">true</span><br>
                    <span class="comment"># すべての権限チェックケース</span><br>
                    efw.auth.cases = admin,user<br>
                    <span class="comment"># ケースごとに定義</span><br>
                    admin.auth.pattern = ^admin.*$<br>
                    admin.url.pattern = [/]*.jsp<br>
                    admin.eventid.pattern = .*
                </div>
            </div>
        </section>

        <section id="injection-security" class="section">
            <h2 class="section-title"><i class="fas fa-syringe"></i> 3. インジェクション攻撃への対応策</h2>
            
            <div class="subsection">
                <h3 class="subsection-title"><i class="fas fa-question-circle"></i> インジェクション攻撃とは？</h3>
                <p>インジェクション（injection）とは、内部に何かを注入することを意味する言葉だ。インジェクション攻撃とは、プログラムがごく普通に受け取る入力データの中にセキュリティを侵害するようなコマンドを巧みに混入し、それをコンピューター内部で機能させてしまう攻撃手口のことをいう。</p>
            </div>
            
            <div class="subsection">
                <h3 class="subsection-title"><i class="fas fa-code"></i> 3-1. JSON通信のJavaScriptインジェクション防止</h3>
                <div class="problem-solution">
                    <div class="problem">
                        <h4><i class="fas fa-exclamation-triangle"></i> eval()使用のリスク</h4>
                        <p>eval()を使用してJSONデータを解析すると、悪意のあるコードが実行される可能性がある。</p>
                    </div>
                    <div class="solution">
                        <h4><i class="fas fa-check-circle"></i> EFWの解決策</h4>
                        <p>クライアントから送信された文字列は直接に、JavaScriptオブジェクトとして利用せず、JSON.parseで変換するため、JSON通信のJavaScriptインジェクションを防いだ。</p>
                        <div class="code-block">
                            <span class="comment">// 安全 - JSON.parseを使用</span><br>
                            <span class="keyword">var</span> data = JSON.parse(requestData);
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="subsection">
                <h3 class="subsection-title"><i class="fas fa-desktop"></i> 3-2. 処理結果自動表示のHTMLインジェクション防止</h3>
                <div class="problem-solution">
                    <div class="problem">
                        <h4><i class="fas fa-exclamation-triangle"></i> html()使用のリスク</h4>
                        <p>jQueryのhtml()メソッドを使用してデータを直接表示すると、HTMLインジェクション攻撃が発生する可能性がある。</p>
                    </div>
                    <div class="solution">
                        <h4><i class="fas fa-check-circle"></i> EFWの解決策</h4>
                        <p>戻り値を画面に描画する際、jQuery機能を生かしてHTMLインジェクションを防いだ。val()やtext()メソッドを使用する。</p>
                        <div class="code-block">
                            <span class="comment">// 安全 - val()とtext()を使用</span><br>
                            <span class="keyword">return</span> (<span class="keyword">new</span> Result())<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;.runat(<span class="string">"body"</span>)<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;.withdata({<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"#span_value"</span>: params[<span class="string">"#input1"</span>]<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;});
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="subsection">
                <h3 class="subsection-title"><i class="fas fa-database"></i> 3-3. プリペアドステートメントのSQLインジェクション防止</h3>
                <div class="problem-solution">
                    <div class="problem">
                        <h4><i class="fas fa-exclamation-triangle"></i> 文字列連結のリスク</h4>
                        <p>文字列連結を使用してSQL文を構築すると、SQLインジェクション攻撃が発生する可能性がある。</p>
                    </div>
                    <div class="solution">
                        <h4><i class="fas fa-check-circle"></i> EFWの解決策</h4>
                        <p>Efwは、外出しSQLのパラメータは、プリペアドステートメント方式のパラメータに変換し、SQLインジェクションを防ぐ。</p>
                        <div class="code-block">
                            <span class="comment">&lt;!-- 安全 - プリペアドステートメントを使用 --&gt;</span><br>
                            &lt;sql id=<span class="string">"select_user_by_uid"</span>&gt;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;SELECT uid, unm, pwd<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;FROM tb_user<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;WHERE uid = :txt_uid<br>
                            &lt;/sql&gt;
                        </div>
                    </div>
                </div>
            </div>
        </section>

		<section class="section">
            <h2 class="section-title"><i class="fas fa-shield-alt"></i> 総合的なセキュリティ保証</h2>
            <p>EFWフレームワークは、多層的なセキュリティメカニズムを通じて、ファイル管理からインジェクション攻撃まで、Webアプリケーションに対する包括的な保護を提供します。</p>
            
            <div class="card-container">
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-lock"></i> ファイルセキュリティ</h3>
                    <p>Web非公開領域への保存、安全なダウンロード機構、ファイル管理ツールの改良を通じて、ファイル漏洩を包括的に防止します。</p>
                </div>
                
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-user-shield"></i> パラメータセキュリティ</h3>
                    <p>パラメータチェック、ログインチェック、ロールチェックを通じて、パラメータ改ざんと不正アクセスを防止します。</极简主义风格p>
                </div>
                
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-bug"></i> インジェクション保護</h3>
                    <p>JSON安全解析、HTML安全表示、SQLプリペアドステートメントにより、各種インジェクション攻撃を包括的に防止します。</p>
                </div>
            </div>
            
            <div class="highlight">
                <p class="highlight-text">EFWフレームワーク - Webアプリケーションに総合的なセキュリティを提供</p>
                <div>
                    <a href="https://github.com/efwGrp/efw4.X" class="btn">GitHubソース</a>
                    <a href="http://id.nii.ac.jp/1001/00147552/" class="btn btn-outline">学術論文</a>
                </div>
            </div>
        </section>
	</div>
    <footer>
        <div class="container">
            <p>EFWフレームワーク - エスコ・ジャパン株式会社によって設計および開発</p>
            <p>© 2025 EFWグループ | 目的指向のWeb開発ソリューション</p>
        </div>
    </footer>

    <script>
        // Language switching function
        function switchLanguage(lang) {
            const pages = {
                'cn': 'security_c.html',
                'jp': 'security_j.html',
                'en': 'security_e.html'
            };
            window.location.href = pages[lang];
        }

        // シンプルなアニメーション効果
        document.addEventListener('DOMContentLoaded', function() {
            const cards = document.querySelectorAll('.card');
            const sections = document.querySelectorAll('.section');
            
            // カードアニメーションを追加
            cards.forEach(card => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                card.style.transition = 'all 0.5s ease';
            });
            
            // セクションアニメーションを追加
            sections.forEach(section => {
                section.style.opacity = '0';
                section.style.transform = 'translateY(20px)';
                section.style.transition = 'all 0.5s ease';
            });
            
            // スクロール時にアニメーションをトリガー
            function checkVisibility() {
                const triggerBottom = window.innerHeight * 0.9;
                
                cards.forEach(card => {
                    const cardTop = card.getBoundingClientRect().top;
                    if (cardTop < triggerBottom) {
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }
                });
                
                sections.forEach(section => {
                    const sectionTop = section.getBoundingClientRect().top;
                    if (sectionTop < triggerBottom) {
                        section.style.opacity = '1';
                        section.style.transform = 'translateY(0)';
                    }
                });
            }
            
            window.addEventListener('scroll', checkVisibility);
            checkVisibility(); // 初期チェック
        });

        // Language switching functionality
        function switchTo(path) {
            window.location.href = path;
        }

    </script>
</body>
</html>